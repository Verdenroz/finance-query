openapi: 3.0.3
info:
  title: Finance Query v2
  version: 2.2.0
  description: |
    REST API for fetching financial data from Yahoo Finance and SEC EDGAR.
    Provides real-time quotes, historical data, news, options, SEC filings, and more.

    EDGAR endpoints require EDGAR_EMAIL environment variable to be configured.
  contact:
    name: Finance Query
    url: https://github.com/verdenroz/finance-query

servers:
  - url: https://finance-query.com
    description: Production server
  - url: http://localhost:8000
    description: Local development server

tags:
  - name: Health
    description: Health check and status endpoints
  - name: Market
    description: Market hours and status
  - name: Quotes
    description: Stock quote and pricing data
  - name: Charts
    description: Historical price data and candlesticks
  - name: Indicators
    description: Technical analysis indicators
  - name: News
    description: Financial news articles
  - name: Options
    description: Options chains and contracts
  - name: Analysis
    description: Analyst recommendations and estimates
  - name: Financials
    description: Company financials and timeseries data
  - name: Holders
    description: Institutional and insider holdings
  - name: Screeners
    description: Predefined Yahoo Finance screeners (equity and fund filters)
  - name: Sectors
    description: Market sector data (GICS sectors)
  - name: Industries
    description: Market industry data (sub-sectors)
  - name: Search
    description: Symbol and company search
  - name: EDGAR
    description: SEC EDGAR filings and XBRL data

paths:
  /v2/health:
    get:
      tags: [Health]
      summary: Health check
      description: Check API health status
      responses:
        '200':
          description: API is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: healthy
                  version:
                    type: string
                    example: 2.1.0
                  timestamp:
                    type: string
                    format: date-time
                    description: Current server timestamp (ISO 8601)

  /v2/ping:
    get:
      tags: [Health]
      summary: Ping endpoint
      description: Simple ping-pong endpoint
      responses:
        '200':
          description: Pong response
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: pong

  /v2/metrics:
    get:
      tags: [Health]
      summary: Prometheus metrics
      description: |
        Exposes Prometheus-format metrics for monitoring.
        Returns request counts, latencies, and error rates per endpoint.
      responses:
        '200':
          description: Prometheus metrics in text format
          content:
            text/plain:
              schema:
                type: string
                description: Prometheus exposition format metrics

  /v2/hours:
    get:
      tags: [Market]
      summary: Get market hours
      description: |
        Fetch current market hours and status for a specific region.
        Returns market open/close times, current status, and timezone information.
      parameters:
        - name: region
          in: query
          schema:
            $ref: '#/components/schemas/Region'
          description: Market region code (defaults to US if not specified)
      responses:
        '200':
          description: Market hours data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HoursResponse'
              example:
                markets:
                  - id: us
                    name: U.S. markets
                    status: closed
                    message: U.S. markets closed
                    open: "2025-12-26T14:30:00Z"
                    close: "2025-12-26T21:00:00Z"
                    time: "2025-12-27T01:06:14Z"
                    timezone: America/New_York
                    timezoneShort: EST
                    gmtOffset: -18000
                    dst: false
        '500':
          $ref: '#/components/responses/InternalError'

  /v2/quote/{symbol}:
    get:
      tags: [Quotes]
      summary: Get quote for a symbol
      description: Fetch detailed quote data for a single stock symbol
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
          example: AAPL
        - name: logo
          in: query
          schema:
            type: boolean
            default: false
          description: Include company logo URL
        - $ref: '#/components/parameters/Format'
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Quote data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Quote'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalError'

  /v2/quotes:
    get:
      tags: [Quotes]
      summary: Get quotes for multiple symbols
      description: |
        Fetch quote data for multiple stock symbols in a single batch request.
      parameters:
        - name: symbols
          in: query
          required: true
          schema:
            type: string
          description: Comma-separated list of symbols
          example: AAPL,MSFT,GOOGL
        - name: logo
          in: query
          schema:
            type: boolean
            default: false
          description: Include company logo URLs
        - $ref: '#/components/parameters/Format'
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Batch quotes response with successful quotes and any errors
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchQuotesResponse'
              example:
                quotes:
                  AAPL:
                    symbol: AAPL
                    shortName: Apple Inc.
                    regularMarketPrice: 182.52
                  MSFT:
                    symbol: MSFT
                    shortName: Microsoft Corporation
                    regularMarketPrice: 378.91
                errors:
                  INVALID: "Symbol not found in response"
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalError'

  /v2/recommendations/{symbol}:
    get:
      tags: [Quotes]
      summary: Get similar stock recommendations
      description: Get recommended similar stocks for a given symbol
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
          example: AAPL
        - name: limit
          in: query
          schema:
            type: integer
            default: 5
          description: Maximum number of recommendations
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Recommendations
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Recommendation'

  /v2/chart/{symbol}:
    get:
      tags: [Charts]
      summary: Get historical chart data
      description: Fetch OHLCV candlestick data for a symbol
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
          example: AAPL
        - name: interval
          in: query
          schema:
            type: string
            enum: [1m, 2m, 5m, 15m, 30m, 60m, 90m, 1h, 1d, 5d, 1wk, 1mo, 3mo]
            default: 1d
          description: Chart interval
        - name: range
          in: query
          schema:
            type: string
            enum: [1d, 5d, 1mo, 3mo, 6mo, 1y, 2y, 5y, 10y, ytd, max]
            default: 1mo
          description: Time range
        - name: events
          in: query
          schema:
            type: boolean
            default: false
          description: Include dividends, splits, and capital gains in response
        - name: patterns
          in: query
          schema:
            type: boolean
            default: false
          description: |
            Detect candlestick patterns and include a per-bar signal array.
            The `patterns` array has the same length as `candles`; each element
            is either a pattern name (e.g. `"Hammer"`, `"BullishEngulfing"`) or
            `null` when no pattern was detected on that bar.
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Chart data (with optional events and patterns)
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/Chart'
                  - type: object
                    properties:
                      patterns:
                        type: array
                        description: |
                          Per-candle pattern signals (when patterns=true).
                          Aligns 1:1 with the `candles` array.
                        items:
                          type: string
                          nullable: true
                          enum:
                            - MorningStar
                            - EveningStar
                            - ThreeWhiteSoldiers
                            - ThreeBlackCrows
                            - BullishEngulfing
                            - BearishEngulfing
                            - BullishHarami
                            - BearishHarami
                            - PiercingLine
                            - DarkCloudCover
                            - TweezerTop
                            - TweezerBottom
                            - Doji
                            - SpinningTop
                            - BullishMarubozu
                            - BearishMarubozu
                            - Hammer
                            - InvertedHammer
                            - HangingMan
                            - ShootingStar
                      dividends:
                        type: array
                        description: Dividend events (when events=true)
                        items:
                          $ref: '#/components/schemas/Dividend'
                      splits:
                        type: array
                        description: Stock split events (when events=true)
                        items:
                          $ref: '#/components/schemas/Split'
                      capitalGains:
                        type: array
                        description: Capital gain distributions (when events=true)
                        items:
                          $ref: '#/components/schemas/CapitalGain'

  /v2/dividends/{symbol}:
    get:
      tags: [Charts]
      summary: Get dividend history
      description: Fetch historical dividend payments for a symbol
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
          example: AAPL
        - name: range
          in: query
          schema:
            type: string
            enum: [1d, 5d, 1mo, 3mo, 6mo, 1y, 2y, 5y, 10y, ytd, max]
            default: max
          description: Time range for dividend history
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Dividend history
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Dividend'
              example:
                - timestamp: 1739197800
                  amount: 0.25
                - timestamp: 1747056600
                  amount: 0.26
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalError'

  /v2/splits/{symbol}:
    get:
      tags: [Charts]
      summary: Get stock split history
      description: Fetch historical stock splits for a symbol
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
          example: AAPL
        - name: range
          in: query
          schema:
            type: string
            enum: [1d, 5d, 1mo, 3mo, 6mo, 1y, 2y, 5y, 10y, ytd, max]
            default: max
          description: Time range for split history
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Stock split history
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Split'
              example:
                - timestamp: 1598880600
                  numerator: 4.0
                  denominator: 1.0
                  ratio: "4:1"
                - timestamp: 1402320600
                  numerator: 7.0
                  denominator: 1.0
                  ratio: "7:1"
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalError'

  /v2/capital-gains/{symbol}:
    get:
      tags: [Charts]
      summary: Get capital gains distribution history
      description: |
        Fetch historical capital gains distributions for a symbol.
        Primarily relevant for mutual funds; most stocks return an empty array.
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
          example: VFIAX
        - name: range
          in: query
          schema:
            type: string
            enum: [1d, 5d, 1mo, 3mo, 6mo, 1y, 2y, 5y, 10y, ytd, max]
            default: max
          description: Time range for capital gains history
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Capital gains distribution history
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CapitalGain'
              example:
                - timestamp: 1702640400
                  amount: 5.23
                - timestamp: 1671104400
                  amount: 4.87
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalError'

  /v2/spark:
    get:
      tags: [Charts]
      summary: Get batch sparkline data
      description: |
        Fetch lightweight chart data for multiple symbols in a single request.
        Optimized for rendering sparkline charts, returning only close prices.
        More efficient than multiple /chart calls when displaying price trends
        for watchlists, dashboards, or portfolio views.
      parameters:
        - name: symbols
          in: query
          required: true
          schema:
            type: string
          description: Comma-separated list of symbols
          example: AAPL,MSFT,GOOGL
        - name: interval
          in: query
          schema:
            type: string
            enum: [1m, 2m, 5m, 15m, 30m, 60m, 90m, 1h, 1d, 5d, 1wk, 1mo, 3mo]
            default: 1d
          description: Chart interval
        - name: range
          in: query
          schema:
            type: string
            enum: [1d, 5d, 1mo, 3mo, 6mo, 1y, 2y, 5y, 10y, ytd, max]
            default: 1mo
          description: Time range
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Batch spark data with successful sparks and any errors
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchSparksResponse'
              example:
                sparks:
                  AAPL:
                    symbol: AAPL
                    closes: [258.61, 258.08, 258.29, 257.04, 256.73]
                    timestamps: [1767969000, 1767969300, 1767969600, 1767969900, 1767970200]
                    interval: "5m"
                    range: "1d"
                    meta:
                      symbol: AAPL
                      currency: USD
                      exchangeName: NMS
                      regularMarketPrice: 258.44
                      previousClose: 259.04
                  MSFT:
                    symbol: MSFT
                    closes: [474.47, 475.20, 475.46, 472.99]
                    timestamps: [1767969000, 1767969300, 1767969600, 1767969900]
                    interval: "5m"
                    range: "1d"
                    meta:
                      symbol: MSFT
                      currency: USD
                      exchangeName: NMS
                      regularMarketPrice: 477.35
                      previousClose: 478.11
                errors: {}
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalError'

  /v2/charts:
    get:
      tags: [Charts]
      summary: Get batch historical chart data
      description: |
        Fetch OHLCV candlestick data for multiple symbols in a single batch request.
        More efficient than multiple /chart/{symbol} calls when displaying charts
        for watchlists or portfolios.
      parameters:
        - name: symbols
          in: query
          required: true
          schema:
            type: string
          description: Comma-separated list of symbols
          example: AAPL,MSFT,GOOGL
        - name: interval
          in: query
          schema:
            type: string
            enum: [1m, 2m, 5m, 15m, 30m, 60m, 90m, 1h, 1d, 5d, 1wk, 1mo, 3mo]
            default: 1d
          description: Chart interval
        - name: range
          in: query
          schema:
            type: string
            enum: [1d, 5d, 1mo, 3mo, 6mo, 1y, 2y, 5y, 10y, ytd, max]
            default: 1mo
          description: Time range
        - name: patterns
          in: query
          schema:
            type: boolean
            default: false
          description: |
            Detect candlestick patterns and include a per-bar signal array in
            each chart object. The `patterns` array aligns 1:1 with `candles`.
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Batch chart data with successful charts and any errors
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchChartsResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalError'

  /v2/dividends:
    get:
      tags: [Charts]
      summary: Get batch dividend history
      description: |
        Fetch dividend history for multiple symbols in a single batch request.
        Returns dividends filtered by the specified time range.
      parameters:
        - name: symbols
          in: query
          required: true
          schema:
            type: string
          description: Comma-separated list of symbols
          example: AAPL,MSFT,KO
        - name: range
          in: query
          schema:
            type: string
            enum: [1d, 5d, 1mo, 3mo, 6mo, 1y, 2y, 5y, 10y, ytd, max]
            default: 1y
          description: Time range for dividend history
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Batch dividend data with successful results and any errors
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchDividendsResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalError'

  /v2/splits:
    get:
      tags: [Charts]
      summary: Get batch stock split history
      description: |
        Fetch stock split history for multiple symbols in a single batch request.
        Returns splits filtered by the specified time range.
      parameters:
        - name: symbols
          in: query
          required: true
          schema:
            type: string
          description: Comma-separated list of symbols
          example: AAPL,TSLA,NVDA
        - name: range
          in: query
          schema:
            type: string
            enum: [1d, 5d, 1mo, 3mo, 6mo, 1y, 2y, 5y, 10y, ytd, max]
            default: 5y
          description: Time range for split history
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Batch split data with successful results and any errors
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchSplitsResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalError'

  /v2/capital-gains:
    get:
      tags: [Charts]
      summary: Get batch capital gains history
      description: |
        Fetch capital gains distribution history for multiple symbols (mainly mutual funds/ETFs).
        Returns capital gains filtered by the specified time range.
      parameters:
        - name: symbols
          in: query
          required: true
          schema:
            type: string
          description: Comma-separated list of symbols
          example: SPY,VOO,VTI
        - name: range
          in: query
          schema:
            type: string
            enum: [1d, 5d, 1mo, 3mo, 6mo, 1y, 2y, 5y, 10y, ytd, max]
            default: 2y
          description: Time range for capital gains history
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Batch capital gains data with successful results and any errors
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchCapitalGainsResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalError'

  /v2/financials:
    get:
      tags: [Financials]
      summary: Get batch financial statements
      description: |
        Fetch financial statements (income, balance, cashflow) for multiple symbols.
        More efficient than multiple /financials/{symbol}/{statement} calls.
      parameters:
        - name: symbols
          in: query
          required: true
          schema:
            type: string
          description: Comma-separated list of symbols
          example: AAPL,MSFT,GOOGL
        - name: statement
          in: query
          required: true
          schema:
            type: string
            enum: [income, balance, cashflow]
          description: Type of financial statement
        - name: frequency
          in: query
          schema:
            type: string
            enum: [annual, quarterly]
            default: annual
          description: Statement frequency
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Batch financial statements with successful results and any errors
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchFinancialsResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalError'

  /v2/recommendations:
    get:
      tags: [Analysis]
      summary: Get batch stock recommendations
      description: |
        Fetch similar stock recommendations for multiple symbols in a single batch request.
        Returns recommended stocks and analyst ratings.
      parameters:
        - name: symbols
          in: query
          required: true
          schema:
            type: string
          description: Comma-separated list of symbols
          example: AAPL,MSFT,GOOGL
        - name: limit
          in: query
          schema:
            type: integer
            default: 5
          description: Maximum number of recommendations per symbol
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Batch recommendations with successful results and any errors
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchRecommendationsResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalError'

  /v2/options:
    get:
      tags: [Options]
      summary: Get batch options chains
      description: |
        Fetch options chains for multiple symbols in a single batch request.
        More efficient than multiple /options/{symbol} calls.
      parameters:
        - name: symbols
          in: query
          required: true
          schema:
            type: string
          description: Comma-separated list of symbols
          example: AAPL,MSFT,SPY
        - name: date
          in: query
          schema:
            type: integer
            format: int64
          description: Unix timestamp for expiration date (optional, defaults to nearest expiration)
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Batch options data with successful results and any errors
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchOptionsResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalError'

  /v2/indicators:
    get:
      tags: [Indicators]
      summary: Get batch technical indicators
      description: |
        Calculate technical analysis indicators for multiple symbols in a single batch request.
        More efficient than multiple /indicators/{symbol} calls when analyzing portfolios.
      parameters:
        - name: symbols
          in: query
          required: true
          schema:
            type: string
          description: Comma-separated list of symbols
          example: AAPL,MSFT,GOOGL
        - name: interval
          in: query
          schema:
            type: string
            enum: [1m, 2m, 5m, 15m, 30m, 60m, 90m, 1h, 1d, 5d, 1wk, 1mo, 3mo]
            default: 1d
          description: Chart interval
        - name: range
          in: query
          schema:
            type: string
            enum: [1d, 5d, 1mo, 3mo, 6mo, 1y, 2y, 5y, 10y, ytd, max]
            default: 1mo
          description: Time range
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Batch indicators with successful results and any errors
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchIndicatorsResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalError'
        '501':
          description: Indicators feature not enabled on server

  /v2/indicators/{symbol}:
    get:
      tags: [Indicators]
      summary: Get technical indicators
      description: Calculate technical analysis indicators from chart data
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
          example: AAPL
        - name: interval
          in: query
          schema:
            type: string
            default: 1d
        - name: range
          in: query
          schema:
            type: string
            default: 1mo
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Technical indicators
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IndicatorsSummary'

  /v2/indices:
    get:
      tags: [Quotes]
      summary: Get world market indices
      description: |
        Fetch quotes for world market indices, optionally filtered by region.
      parameters:
        - name: region
          in: query
          required: false
          schema:
            type: string
            enum: [americas, europe, asia-pacific, middle-east-africa, currencies]
          description: Filter by region (returns all if not specified)
        - $ref: '#/components/parameters/Format'
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Batch quotes response for world indices
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchQuotesResponse'
        '500':
          $ref: '#/components/responses/InternalError'

  /v2/news:
    get:
      tags: [News]
      summary: Get general market news
      description: Fetch general financial market news (scraped from stockanalysis.com)
      parameters:
        - name: count
          in: query
          schema:
            type: integer
            default: 10
          description: Number of articles to return
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: News articles
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/NewsArticle'
              example:
                - title: "Fed holds rates steady amid inflation concerns"
                  link: "https://www.reuters.com/article/fed-rates"
                  source: "Reuters"
                  img: "https://cdn.snapi.dev/images/v1/f/e/d/gen1.jpg"
                  time: "2 hours ago"

  /v2/news/{symbol}:
    get:
      tags: [News]
      summary: Get news for a symbol
      description: Fetch news articles related to a specific stock (scraped from stockanalysis.com)
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
          example: AAPL
        - name: count
          in: query
          schema:
            type: integer
            default: 10
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Symbol news array
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/NewsArticle'
              example:
                - title: "Apple announces new iPhone model"
                  link: "https://www.reuters.com/article/apple-iphone"
                  source: "Reuters"
                  img: "https://cdn.snapi.dev/images/v1/a/p/p/aapl1.jpg"
                  time: "1 hour ago"

  /v2/options/{symbol}:
    get:
      tags: [Options]
      summary: Get options chain
      description: Fetch options contracts for a symbol
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
          example: AAPL
        - name: date
          in: query
          schema:
            type: integer
          description: Expiration date (Unix timestamp)
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Options chain
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OptionsResponse'

  /v2/financials/{symbol}/{statement}:
    get:
      tags: [Financials]
      summary: Get financial statements
      description: |
        Fetch financial statement data (income statement, balance sheet, or cash flow) for a symbol.
        Returns historical data with metrics organized by date.
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
          description: Stock symbol
          example: AAPL
        - name: statement
          in: path
          required: true
          schema:
            type: string
            enum: [income, balance, cashflow]
          description: Type of financial statement
          example: income
        - name: frequency
          in: query
          schema:
            type: string
            enum: [annual, quarterly]
            default: annual
          description: Data frequency (annual or quarterly)
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Financial statement data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FinancialStatement'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          description: Symbol not found or no data available
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /v2/quote-type/{symbol}:
    get:
      tags: [Quotes]
      summary: Get quote type
      description: Get the type of quote (EQUITY, ETF, etc.)
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
          example: AAPL
      responses:
        '200':
          description: Quote type
          content:
            application/json:
              schema:
                type: object

  /v2/holders/{symbol}/{type}:
    get:
      tags: [Holders]
      summary: Get holder data
      description: |
        Fetch holder data for a symbol by type.
        Available types:
        - major: Major institutional holders
        - institutional: Institutional holder positions
        - mutualfund: Mutual fund holder positions
        - insider-transactions: Insider trading transactions
        - insider-purchases: Insider purchase history
        - insider-roster: List of company insiders
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
          description: Stock symbol
          example: AAPL
        - name: type
          in: path
          required: true
          schema:
            type: string
            enum: [major, institutional, mutualfund, insider-transactions, insider-purchases, insider-roster]
          description: Type of holder data
          example: major
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Holder data
          content:
            application/json:
              schema:
                type: object
        '400':
          $ref: '#/components/responses/BadRequest'

  /v2/analysis/{symbol}/{type}:
    get:
      tags: [Analysis]
      summary: Get analysis data
      description: |
        Fetch analysis data for a symbol by type.
        Available types:
        - recommendations: Analyst recommendation trends over time
        - upgrades-downgrades: Analyst rating changes
        - earnings-estimate: Analyst earnings estimates
        - earnings-history: Historical earnings data
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
          description: Stock symbol
          example: AAPL
        - name: type
          in: path
          required: true
          schema:
            type: string
            enum: [recommendations, upgrades-downgrades, earnings-estimate, earnings-history]
          description: Type of analysis data
          example: recommendations
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Analysis data
          content:
            application/json:
              schema:
                type: object
        '400':
          $ref: '#/components/responses/BadRequest'

  /v2/screeners/{screener_type}:
    get:
      tags: [Screeners]
      summary: Get screener results
      description: |
        Fetch stocks or funds matching predefined screener criteria.

        **Equity Screeners (9):**
        - `aggressive-small-caps`: Small caps with high EPS growth
        - `day-gainers`: Top gaining stocks (>3% change, >$2B market cap)
        - `day-losers`: Top losing stocks (<-2.5% change, >$2B market cap)
        - `growth-technology-stocks`: Tech stocks with 25%+ revenue/EPS growth
        - `most-actives`: Most actively traded by volume
        - `most-shorted-stocks`: Highest short interest percentage
        - `small-cap-gainers`: Small cap gainers (<$2B market cap)
        - `undervalued-growth-stocks`: Low P/E with high EPS growth
        - `undervalued-large-caps`: Large caps with low P/E and PEG

        **Fund Screeners (6):**
        - `conservative-foreign-funds`: Low-risk foreign large cap funds
        - `high-yield-bond`: High yield bond funds
        - `portfolio-anchors`: Large blend core funds
        - `solid-large-growth-funds`: Large growth funds
        - `solid-midcap-growth-funds`: Mid-cap growth funds
        - `top-mutual-funds`: Top performing mutual funds
      parameters:
        - name: screener_type
          in: path
          required: true
          schema:
            type: string
            enum:
              - aggressive-small-caps
              - day-gainers
              - day-losers
              - growth-technology-stocks
              - most-actives
              - most-shorted-stocks
              - small-cap-gainers
              - undervalued-growth-stocks
              - undervalued-large-caps
              - conservative-foreign-funds
              - high-yield-bond
              - portfolio-anchors
              - solid-large-growth-funds
              - solid-midcap-growth-funds
              - top-mutual-funds
          description: Predefined screener type
          example: most-actives
        - name: count
          in: query
          schema:
            type: integer
            default: 25
            maximum: 250
          description: Number of results to return (max 250)
        - $ref: '#/components/parameters/Format'
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Screener results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScreenersResponse'
              example:
                quotes:
                  - symbol: NVDA
                    shortName: NVIDIA Corporation
                    quoteType: EQUITY
                    regularMarketPrice:
                      raw: 134.70
                      fmt: "134.70"
                    regularMarketChangePercent:
                      raw: 1.85
                      fmt: "1.85%"
                type: most_actives
                description: "Stocks ordered in descending order by intraday trade volume"
                lastUpdated: 1735315200
        '400':
          $ref: '#/components/responses/BadRequest'

  /v2/screeners/custom:
    post:
      tags: [Screeners]
      summary: Custom screener query
      description: |
        Build custom screener queries with flexible filtering criteria.

        **Quote Types:**
        - `EQUITY` - Stocks (default)
        - `MUTUALFUND` - Mutual funds

        **Operators:**
        - `eq` - Equal to (for string fields like region, sector)
        - `gt` - Greater than
        - `gte` - Greater than or equal
        - `lt` - Less than
        - `lte` - Less than or equal
        - `btwn` - Between (requires array value: `[min, max]`)

        **Common Equity Fields:**
        - `region` - Market region (e.g., "us", "gb")
        - `sector` - Industry sector (e.g., "Technology", "Healthcare")
        - `industry` - Specific industry
        - `exchange` - Exchange code (e.g., "NMS", "NYQ")
        - `intradaymarketcap` - Market capitalization
        - `intradayprice` - Current price
        - `percentchange` - Percent change
        - `avgdailyvol3m` - 3-month average daily volume
        - `peratio.lasttwelvemonths` - P/E ratio (TTM)
        - `forward_dividend_yield` - Forward dividend yield
        - `returnonequity.lasttwelvemonths` - Return on equity
        - `short_percentage_of_float.value` - Short interest % of float
        - `esg_score` - ESG score

        **Common Fund Fields:**
        - `categoryname` - Fund category (e.g., "Large Growth")
        - `performanceratingoverall` - Morningstar rating (1-5)
        - `riskratingoverall` - Risk rating (1-5)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomScreenerRequest'
            examples:
              highVolumeLargeCaps:
                summary: Large cap stocks with high volume
                value:
                  quoteType: EQUITY
                  size: 10
                  sortField: intradaymarketcap
                  sortType: DESC
                  filters:
                    - field: region
                      operator: eq
                      value: us
                    - field: intradaymarketcap
                      operator: gt
                      value: 100000000000
                    - field: avgdailyvol3m
                      operator: gt
                      value: 1000000
              highDividend:
                summary: High dividend yield stocks
                value:
                  quoteType: EQUITY
                  size: 25
                  sortField: forward_dividend_yield
                  sortType: DESC
                  filters:
                    - field: region
                      operator: eq
                      value: us
                    - field: forward_dividend_yield
                      operator: gt
                      value: 4
              priceRange:
                summary: Stocks in price range $50-$100
                value:
                  quoteType: EQUITY
                  size: 20
                  filters:
                    - field: region
                      operator: eq
                      value: us
                    - field: intradayprice
                      operator: btwn
                      value: [50, 100]
              topRatedFunds:
                summary: Top rated mutual funds
                value:
                  quoteType: MUTUALFUND
                  size: 10
                  filters:
                    - field: performanceratingoverall
                      operator: gte
                      value: 4
      responses:
        '200':
          description: Custom screener results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScreenersResponse'
              example:
                quotes:
                  - symbol: NVDA
                    shortName: NVIDIA Corporation
                    quoteType: EQUITY
                    regularMarketPrice: 134.70
                    regularMarketChangePercent: 1.85
                type: custom
                description: "Custom screener query results"
                total: 2432
        '400':
          $ref: '#/components/responses/BadRequest'

  /v2/sectors/{sector_type}:
    get:
      tags: [Sectors]
      summary: Get sector data
      description: |
        Fetch comprehensive data for a market sector including overview, performance,
        top companies, ETFs, mutual funds, industries, and research reports.

        **Available Sectors (11 GICS Sectors):**
        - `technology` - Technology (30.38% market weight)
        - `financial-services` - Financial Services (13.74%)
        - `consumer-cyclical` - Consumer Cyclical (10.15%)
        - `communication-services` - Communication Services (9.55%)
        - `healthcare` - Healthcare (10.52%)
        - `industrials` - Industrials (8.27%)
        - `consumer-defensive` - Consumer Defensive (5.72%)
        - `energy` - Energy (3.24%)
        - `basic-materials` - Basic Materials (1.86%)
        - `real-estate` - Real Estate (2.32%)
        - `utilities` - Utilities (2.46%)
      parameters:
        - name: sector_type
          in: path
          required: true
          schema:
            type: string
            enum:
              - technology
              - financial-services
              - consumer-cyclical
              - communication-services
              - healthcare
              - industrials
              - consumer-defensive
              - energy
              - basic-materials
              - real-estate
              - utilities
          description: Sector type
          example: technology
        - $ref: '#/components/parameters/Format'
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Sector data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SectorResponse'
              example:
                name: Technology
                key: technology
                symbol: "^YH311"
                overview:
                  companiesCount: 828
                  marketWeight: 0.3038
                  description: "Companies in the technology sector..."
                performance:
                  dayChangePercent: 0.00008798734
                  ytdChangePercent: 0.21215253
                  oneYearChangePercent: 0.18625236
                  threeYearChangePercent: 1.542715
                  fiveYearChangePercent: 1.2627318
                benchmark:
                  dayChangePercent: 0.00049908913
                  ytdChangePercent: -0.00871
                  oneYearChangePercent: 0.12957759
                benchmarkName: S&P 500
                topCompanies:
                  - symbol: NVDA
                    name: NVIDIA Corporation
                    lastPrice: 190.53
                    marketCap: 4638833880279
                    marketWeight: 0.19622724
                    rating: Strong Buy
                industries:
                  - name: Semiconductors
                    key: semiconductors
                    marketWeight: 0.3401587
        '400':
          $ref: '#/components/responses/BadRequest'

  /v2/industries/{industry_key}:
    get:
      tags: [Industries]
      summary: Get industry data
      description: |
        Fetch comprehensive data for a market industry including overview, performance,
        top companies, top performing companies, top growth companies, and research reports.

        Industry keys can be discovered from the `/v2/sectors/{sector}` endpoint, which returns
        the industries within each sector.

        **Example industry keys:**
        - `semiconductors` (Technology)
        - `software-infrastructure` (Technology)
        - `banks-diversified` (Financial Services)
        - `biotechnology` (Healthcare)
        - `internet-retail` (Consumer Cyclical)
        - `oil-gas-integrated` (Energy)
        - `aerospace-defense` (Industrials)
      parameters:
        - name: industry_key
          in: path
          required: true
          schema:
            type: string
          description: Industry key/slug (discoverable from sectors endpoint)
          example: semiconductors
        - $ref: '#/components/parameters/Format'
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Industry data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IndustryResponse'
              example:
                name: Semiconductors
                key: semiconductors
                sectorName: Technology
                sectorKey: technology
                overview:
                  companiesCount: 59
                  marketCap: 8057445154816
                  marketWeight: 0.3401587
                  description: "Semiconductor companies that design, manufacture..."
                performance:
                  dayChangePercent: 0.0000075706953
                  ytdChangePercent: 0.44191968
                  oneYearChangePercent: 0.4046737
                benchmark:
                  name: S&P 500
                  ytdChangePercent: 0.17318612
                topCompanies:
                  - symbol: NVDA
                    name: NVIDIA Corporation
                    lastPrice: 190.53
                    marketCap: 4638833880279
                    marketWeight: 0.57597184
                    rating: Strong Buy
                topPerformingCompanies:
                  - symbol: LASR
                    name: nLIGHT, Inc.
                    ytdReturn: 2.7369
                topGrowthCompanies:
                  - symbol: MU
                    name: Micron Technology, Inc.
                    growthEstimate: 5.846153846153847
        '404':
          description: Industry not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /v2/currencies:
    get:
      tags: [Market]
      summary: Get available currencies
      description: |
        Fetch available currency pairs from Yahoo Finance.
        Returns a list of currency pairs that can be used for forex trading/tracking.
      responses:
        '200':
          description: List of available currencies
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Currency'
              example:
                - shortName: "USD/EUR"
                  longName: "USD/EUR"
                  symbol: "USDEUR=X"
                  localLongName: "USD/EUR"
                - shortName: "USD/JPY"
                  longName: "USD/JPY"
                  symbol: "USDJPY=X"
                  localLongName: "USD/JPY"
        '500':
          $ref: '#/components/responses/InternalError'

  /v2/edgar/cik/{symbol}:
    get:
      tags: [EDGAR]
      summary: Resolve ticker to CIK
      description: |
        Resolve a ticker symbol to its SEC CIK (Central Index Key) number.
        Requires EDGAR_EMAIL environment variable to be configured.
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
            example: AAPL
          description: Stock ticker symbol
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: CIK resolved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  symbol:
                    type: string
                    example: AAPL
                  cik:
                    type: integer
                    example: 320193
        '404':
          description: Symbol not found in SEC database
        '503':
          description: EDGAR client not configured

  /v2/edgar/submissions/{symbol}:
    get:
      tags: [EDGAR]
      summary: Get SEC filing history
      description: |
        Fetch filing history and company metadata from SEC EDGAR.
        Returns up to 1000 most recent filings with company information.
        Requires EDGAR_EMAIL environment variable to be configured.
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
            example: AAPL
          description: Stock ticker symbol
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Filing history retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  cik:
                    type: string
                    example: "0000320193"
                  name:
                    type: string
                    example: "Apple Inc."
                  sic:
                    type: string
                    example: "3571"
                  sicDescription:
                    type: string
                    example: "Electronic Computers"
                  ein:
                    type: string
                    example: "942404110"
                  website:
                    type: string
                    example: "https://www.apple.com"
                  filings:
                    type: object
                    description: Recent filings (up to 1000)
        '404':
          description: Symbol not found
        '503':
          description: EDGAR client not configured

  /v2/edgar/facts/{symbol}:
    get:
      tags: [EDGAR]
      summary: Get XBRL financial data
      description: |
        Fetch structured XBRL financial data from SEC EDGAR.
        Returns all extracted XBRL facts organized by taxonomy (us-gaap, ifrs, dei).
        Response can be several MB for major companies.
        Requires EDGAR_EMAIL environment variable to be configured.
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
            example: AAPL
          description: Stock ticker symbol
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: XBRL facts retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  cik:
                    type: integer
                    example: 320193
                  entityName:
                    type: string
                    example: "Apple Inc."
                  facts:
                    type: object
                    description: Facts organized by taxonomy (us-gaap, ifrs, dei)
        '404':
          description: Symbol not found
        '503':
          description: EDGAR client not configured

  /v2/edgar/search:
    get:
      tags: [EDGAR]
      summary: Search SEC filings
      description: |
        Full-text search across SEC EDGAR filings.
        Search by keywords with optional form type and date filters.
        Requires EDGAR_EMAIL environment variable to be configured.
      parameters:
        - name: q
          in: query
          required: true
          schema:
            type: string
            example: artificial intelligence
          description: Search query string
        - name: forms
          in: query
          required: false
          schema:
            type: string
            example: "10-K,10-Q"
          description: Comma-separated form types to filter (e.g., "10-K,10-Q,8-K")
        - name: start_date
          in: query
          required: false
          schema:
            type: string
            format: date
            example: "2024-01-01"
          description: Start date in YYYY-MM-DD format
        - name: end_date
          in: query
          required: false
          schema:
            type: string
            format: date
            example: "2024-12-31"
          description: End date in YYYY-MM-DD format
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Search results
          content:
            application/json:
              schema:
                type: object
                properties:
                  hits:
                    type: object
                    properties:
                      total:
                        type: object
                        properties:
                          value:
                            type: integer
                            example: 10000
                          relation:
                            type: string
                            example: "gte"
                      hits:
                        type: array
                        items:
                          type: object
                          description: Search hit with _source containing filing data
        '503':
          description: EDGAR client not configured

  /v2/exchanges:
    get:
      tags: [Market]
      summary: Get supported exchanges
      description: |
        Fetch list of supported exchanges from Yahoo Finance.
        Returns exchanges with their symbol suffixes and data delay information.
      responses:
        '200':
          description: List of supported exchanges
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Exchange'
              example:
                - country: "United States of America"
                  market: "Nasdaq Stock Exchange"
                  suffix: "N/A"
                  delay: "Real-time"
                  dataProvider: "ICE Data Services"
                - country: "Japan"
                  market: "Tokyo Stock Exchange"
                  suffix: ".T"
                  delay: "20 min"
                  dataProvider: "ICE Data Services"
        '500':
          $ref: '#/components/responses/InternalError'

  /v2/market-summary:
    get:
      tags: [Market]
      summary: Get market summary
      description: |
        Fetch market summary with major indices, currencies, and commodities.
        Returns real-time data for key market indicators.
      parameters:
        - name: region
          in: query
          required: false
          schema:
            $ref: '#/components/schemas/Region'
          description: Region code for localization (defaults to US)
        - $ref: '#/components/parameters/Format'
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Market summary data
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MarketSummaryQuote'
              example:
                - symbol: "^GSPC"
                  fullExchangeName: "SNP"
                  exchange: "SNP"
                  shortName: "S&P 500"
                  quoteType: "INDEX"
                  marketState: "CLOSED"
                  regularMarketPrice: 5970.84
                  regularMarketChange: -64.16
                  regularMarketChangePercent: -1.06
        '500':
          $ref: '#/components/responses/InternalError'

  /v2/trending:
    get:
      tags: [Market]
      summary: Get trending tickers
      description: |
        Fetch trending stock symbols for a specific region.
        Returns the most popular/trending stocks based on Yahoo Finance data.
      parameters:
        - name: region
          in: query
          required: false
          schema:
            $ref: '#/components/schemas/Region'
          description: Region code for localization (defaults to US)
      responses:
        '200':
          description: List of trending tickers
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TrendingQuote'
              example:
                - symbol: "NVDA"
                - symbol: "TSLA"
                - symbol: "AAPL"
                - symbol: "AMD"
                - symbol: "PLTR"
        '500':
          $ref: '#/components/responses/InternalError'

  /v2/search:
    get:
      tags: [Search]
      summary: Search symbols and companies
      description: |
        Search for stock symbols, companies, news, and research reports on Yahoo Finance.
        Supports fuzzy matching, logo URLs, and cultural assets (NFT indices).
      parameters:
        - name: q
          in: query
          required: true
          schema:
            type: string
          description: Search query
          example: Apple
        - name: quotes
          in: query
          schema:
            type: integer
            default: 10
          description: Maximum number of quote results
        - name: news
          in: query
          schema:
            type: integer
            default: 0
          description: Maximum number of news results (0 to disable)
        - name: fuzzy
          in: query
          schema:
            type: boolean
            default: false
          description: Enable fuzzy matching for typos
        - name: logo
          in: query
          schema:
            type: boolean
            default: true
          description: Include logo URLs in results
        - name: research
          in: query
          schema:
            type: boolean
            default: false
          description: Include research reports in results
        - name: cultural
          in: query
          schema:
            type: boolean
            default: false
          description: Include cultural assets (NFT indices) in results
        - name: region
          in: query
          schema:
            $ref: '#/components/schemas/Region'
          description: Region for language/localization settings (defaults to US)
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Search results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchResponse'
              example:
                count: 6
                quotes:
                  - symbol: AAPL
                    shortName: Apple Inc.
                    longName: Apple Inc.
                    quoteType: EQUITY
                    exchange: NMS
                    exchDisp: NASDAQ
                    typeDisp: Equity
                    sector: Technology
                    sectorDisp: Technology
                    industry: Consumer Electronics
                    industryDisp: Consumer Electronics
                    logoUrl: "https://s.yimg.com/lb/..."
                    score: 100000.0
                    isYahooFinance: true
                news:
                  - uuid: "abc123"
                    title: "Apple announces new product"
                    publisher: "Reuters"
                    link: "https://..."
                    providerPublishTime: 1735315200
                    type: STORY
                researchReports:
                  - reportHeadline: "Apple Q4 Analysis"
                    author: "John Doe"
                    provider: "Argus Research"
        '400':
          $ref: '#/components/responses/BadRequest'

  /v2/lookup:
    get:
      tags: [Search]
      summary: Look up symbols by type
      description: |
        Type-filtered symbol lookup. Unlike search, lookup specializes in discovering tickers
        filtered by asset type (equity, ETF, mutual fund, index, future, currency, cryptocurrency).

        Optionally fetches logo URLs via an additional API call when `logo=true`.
      parameters:
        - name: q
          in: query
          required: true
          schema:
            type: string
          description: Lookup query
          example: Apple
        - name: type
          in: query
          schema:
            type: string
            enum: [all, equity, mutualfund, etf, index, future, currency, cryptocurrency]
            default: all
          description: Asset type filter
        - name: count
          in: query
          schema:
            type: integer
            default: 25
            maximum: 100
          description: Maximum number of results
        - name: logo
          in: query
          schema:
            type: boolean
            default: false
          description: Include logo URLs (requires additional API call)
        - name: region
          in: query
          schema:
            $ref: '#/components/schemas/Region'
          description: Region for language/localization settings (defaults to US)
        - $ref: '#/components/parameters/Fields'
      responses:
        '200':
          description: Lookup results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LookupResponse'
              examples:
                equity:
                  summary: Equity lookup
                  value:
                    count: 3
                    start: 0
                    quotes:
                      - symbol: AAPL
                        shortName: Apple Inc.
                        quoteType: equity
                        exchange: NMS
                        regularMarketPrice: 273.40
                        regularMarketChange: -0.41
                      - symbol: APLE
                        shortName: Apple Hospitality REIT, Inc.
                        quoteType: equity
                        exchange: NYQ
                        regularMarketPrice: 12.04
                        regularMarketChange: -0.05
                withLogo:
                  summary: With logo URLs
                  value:
                    count: 1
                    start: 0
                    quotes:
                      - symbol: NVDA
                        shortName: NVIDIA Corporation
                        quoteType: equity
                        exchange: NMS
                        regularMarketPrice: 190.53
                        regularMarketChange: 1.92
                        logoUrl: "https://s.yimg.com/lb/brands/50x50_nvidia.png"
                        companyLogoUrl: "https://s.yimg.com/lb/brands/50x50_nvidia.png"
        '400':
          $ref: '#/components/responses/BadRequest'

  /v2/transcripts/{symbol}:
    get:
      tags: [Analysis]
      summary: Get earnings transcript
      description: Fetch earnings call transcript for a symbol. Returns the latest transcript by default, or a specific quarter/year if provided.
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
            default: AAPL
          description: Stock symbol (e.g., AAPL, MSFT)
        - name: quarter
          in: query
          required: false
          schema:
            type: string
            enum: [Q1, Q2, Q3, Q4]
            default: Q4
          description: Fiscal quarter (defaults to latest)
        - name: year
          in: query
          required: false
          schema:
            type: integer
            default: 2025
          description: Fiscal year (defaults to latest)
      responses:
        '200':
          description: Earnings transcript
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Transcript'

  /v2/transcripts/{symbol}/all:
    get:
      tags: [Analysis]
      summary: Get all earnings transcripts
      description: Fetch all available earnings call transcripts for a symbol
      parameters:
        - name: symbol
          in: path
          required: true
          schema:
            type: string
            default: AAPL
          description: Stock symbol (e.g., AAPL, MSFT)
        - name: limit
          in: query
          required: false
          schema:
            type: integer
          description: Maximum number of transcripts to return
      responses:
        '200':
          description: List of earnings transcripts
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TranscriptWithMeta'

components:
  parameters:
    Format:
      name: format
      in: query
      schema:
        type: string
        enum: [raw, pretty, both]
        default: raw
      description: |
        Controls how FormattedValue fields are displayed
    Fields:
      name: fields
      in: query
      required: false
      schema:
        type: string
        nullable: true
      description: |
        Comma-separated list of field names to include in response, defaults to all fields if not specified

  schemas:
    Quote:
      type: object
      description: Stock quote data
      properties:
        symbol:
          type: string
          example: AAPL
        regularMarketPrice:
          type: number
          format: double
          example: 182.52
        regularMarketChange:
          type: number
          format: double
        regularMarketChangePercent:
          type: number
          format: double
        regularMarketVolume:
          type: integer
          format: int64
        marketCap:
          type: integer
          format: int64
        fiftyTwoWeekHigh:
          type: number
          format: double
        fiftyTwoWeekLow:
          type: number
          format: double
        logoUrl:
          type: string
          nullable: true
        companyLogoUrl:
          type: string
          nullable: true

    Transcript:
      type: object
      description: Earnings call transcript
      properties:
        transcriptContent:
          type: object
          properties:
            company_id:
              type: integer
            event_id:
              type: integer
            version:
              type: string
            speaker_mapping:
              type: array
              items:
                type: object
                properties:
                  speaker:
                    type: integer
                  speaker_data:
                    type: object
                    properties:
                      name:
                        type: string
                      role:
                        type: string
                        nullable: true
                      company:
                        type: string
                        nullable: true
            transcript:
              type: object
              properties:
                number_of_speakers:
                  type: integer
                text:
                  type: string
                paragraphs:
                  type: array
                  items:
                    type: object
        transcriptMetadata:
          type: object
          properties:
            date:
              type: integer
            eventId:
              type: integer
            eventType:
              type: string
            fiscalPeriod:
              type: string
              example: Q4
            fiscalYear:
              type: integer
              example: 2025
            isLatest:
              type: boolean
            title:
              type: string

    TranscriptWithMeta:
      type: object
      description: Transcript with additional metadata from earnings call list
      properties:
        eventId:
          type: string
        quarter:
          type: string
          nullable: true
        year:
          type: integer
          nullable: true
        title:
          type: string
        url:
          type: string
        transcript:
          $ref: '#/components/schemas/Transcript'

    BatchQuotesResponse:
      type: object
      description: Response from batch quotes endpoint with successful quotes and errors
      properties:
        quotes:
          type: object
          description: Successfully fetched quotes, keyed by symbol
          additionalProperties:
            $ref: '#/components/schemas/Quote'
          example:
            AAPL:
              symbol: AAPL
              shortName: Apple Inc.
              regularMarketPrice: 182.52
            MSFT:
              symbol: MSFT
              shortName: Microsoft Corporation
              regularMarketPrice: 378.91
        errors:
          type: object
          description: Symbols that failed to fetch, with error messages
          additionalProperties:
            type: string
          example:
            INVALID: "Symbol not found in response"

    Chart:
      type: object
      properties:
        symbol:
          type: string
        meta:
          $ref: '#/components/schemas/ChartMeta'
        candles:
          type: array
          items:
            $ref: '#/components/schemas/Candle'
        interval:
          type: string
        range:
          type: string

    ChartMeta:
      type: object
      properties:
        currency:
          type: string
        symbol:
          type: string
        exchangeName:
          type: string
        instrumentType:
          type: string
        firstTradeDate:
          type: integer
        regularMarketTime:
          type: integer
        gmtoffset:
          type: integer
        timezone:
          type: string
        exchangeTimezoneName:
          type: string
        regularMarketPrice:
          type: number
        chartPreviousClose:
          type: number
        dataGranularity:
          type: string
        range:
          type: string

    Candle:
      type: object
      properties:
        timestamp:
          type: integer
          format: int64
        open:
          type: number
          format: double
        high:
          type: number
          format: double
        low:
          type: number
          format: double
        close:
          type: number
          format: double
        volume:
          type: integer
          format: int64
        adjClose:
          type: number
          format: double
          nullable: true

    Dividend:
      type: object
      description: Dividend payment event
      properties:
        timestamp:
          type: integer
          format: int64
          description: Unix timestamp of the dividend ex-date
          example: 1739197800
        amount:
          type: number
          format: double
          description: Dividend amount per share
          example: 0.25

    Split:
      type: object
      description: Stock split event
      properties:
        timestamp:
          type: integer
          format: int64
          description: Unix timestamp of the split date
          example: 1598880600
        numerator:
          type: number
          format: double
          description: Split numerator (shares received)
          example: 4.0
        denominator:
          type: number
          format: double
          description: Split denominator (shares held)
          example: 1.0
        ratio:
          type: string
          description: Human-readable split ratio
          example: "4:1"

    CapitalGain:
      type: object
      description: Capital gain distribution event (primarily for mutual funds)
      properties:
        timestamp:
          type: integer
          format: int64
          description: Unix timestamp of the distribution date
          example: 1702640400
        amount:
          type: number
          format: double
          description: Capital gain distribution amount per share
          example: 5.23

    IndicatorsSummary:
      type: object
      description: |
        Technical analysis indicators summary. All fields are optional  only those computable
        from the available data range are included. Field names are camelCase.
      properties:
        # === MOVING AVERAGES ===
        sma10:
          type: number
          nullable: true
          description: Simple Moving Average (10-period)
        sma20:
          type: number
          nullable: true
          description: Simple Moving Average (20-period)
        sma50:
          type: number
          nullable: true
          description: Simple Moving Average (50-period)
        sma100:
          type: number
          nullable: true
          description: Simple Moving Average (100-period)
        sma200:
          type: number
          nullable: true
          description: Simple Moving Average (200-period)
        ema10:
          type: number
          nullable: true
          description: Exponential Moving Average (10-period)
        ema20:
          type: number
          nullable: true
          description: Exponential Moving Average (20-period)
        ema50:
          type: number
          nullable: true
          description: Exponential Moving Average (50-period)
        ema100:
          type: number
          nullable: true
          description: Exponential Moving Average (100-period)
        ema200:
          type: number
          nullable: true
          description: Exponential Moving Average (200-period)
        wma10:
          type: number
          nullable: true
          description: Weighted Moving Average (10-period)
        wma20:
          type: number
          nullable: true
          description: Weighted Moving Average (20-period)
        wma50:
          type: number
          nullable: true
          description: Weighted Moving Average (50-period)
        wma100:
          type: number
          nullable: true
          description: Weighted Moving Average (100-period)
        wma200:
          type: number
          nullable: true
          description: Weighted Moving Average (200-period)
        dema20:
          type: number
          nullable: true
          description: Double Exponential Moving Average (20-period)
        tema20:
          type: number
          nullable: true
          description: Triple Exponential Moving Average (20-period)
        hma20:
          type: number
          nullable: true
          description: Hull Moving Average (20-period)
        vwma20:
          type: number
          nullable: true
          description: Volume Weighted Moving Average (20-period)
        alma9:
          type: number
          nullable: true
          description: Arnaud Legoux Moving Average (9-period)
        mcginleyDynamic20:
          type: number
          nullable: true
          description: McGinley Dynamic indicator (20-period)
        # === MOMENTUM OSCILLATORS ===
        rsi14:
          type: number
          nullable: true
          description: Relative Strength Index (14-period)
        stochastic:
          $ref: '#/components/schemas/StochasticData'
        stochasticRsi:
          $ref: '#/components/schemas/StochasticData'
        cci20:
          type: number
          nullable: true
          description: Commodity Channel Index (20-period)
        williamsR14:
          type: number
          nullable: true
          description: Williams %R (14-period)
        roc12:
          type: number
          nullable: true
          description: Rate of Change (12-period)
        momentum10:
          type: number
          nullable: true
          description: Momentum oscillator (10-period)
        cmo14:
          type: number
          nullable: true
          description: Chande Momentum Oscillator (14-period)
        awesomeOscillator:
          type: number
          nullable: true
          description: Awesome Oscillator (5/34-period)
        coppockCurve:
          type: number
          nullable: true
          description: Coppock Curve
        # === TREND INDICATORS ===
        macd:
          $ref: '#/components/schemas/MacdData'
        adx14:
          type: number
          nullable: true
          description: Average Directional Index (14-period)
        aroon:
          $ref: '#/components/schemas/AroonData'
        supertrend:
          $ref: '#/components/schemas/SuperTrendData'
        ichimoku:
          $ref: '#/components/schemas/IchimokuData'
        parabolicSar:
          type: number
          nullable: true
          description: Parabolic SAR
        bullBearPower:
          $ref: '#/components/schemas/BullBearPowerData'
        elderRayIndex:
          $ref: '#/components/schemas/ElderRayData'
        # === VOLATILITY INDICATORS ===
        bollingerBands:
          $ref: '#/components/schemas/BollingerBandsData'
        keltnerChannels:
          $ref: '#/components/schemas/ChannelData'
        donchianChannels:
          $ref: '#/components/schemas/ChannelData'
        atr14:
          type: number
          nullable: true
          description: Average True Range (14-period)
        trueRange:
          type: number
          nullable: true
          description: True Range (current candle)
        choppinessIndex14:
          type: number
          nullable: true
          description: Choppiness Index (14-period)
        # === VOLUME INDICATORS ===
        obv:
          type: number
          nullable: true
          description: On-Balance Volume
        mfi14:
          type: number
          nullable: true
          description: Money Flow Index (14-period)
        cmf20:
          type: number
          nullable: true
          description: Chaikin Money Flow (20-period)
        chaikinOscillator:
          type: number
          nullable: true
          description: Chaikin Oscillator (3/10-period)
        accumulationDistribution:
          type: number
          nullable: true
          description: Accumulation/Distribution Line
        vwap:
          type: number
          nullable: true
          description: Volume Weighted Average Price
        balanceOfPower:
          type: number
          nullable: true
          description: Balance of Power indicator

    StochasticData:
      type: object
      nullable: true
      properties:
        k:
          type: number
          nullable: true
          description: Stochastic %K line
        d:
          type: number
          nullable: true
          description: Stochastic %D signal line

    MacdData:
      type: object
      nullable: true
      properties:
        macd:
          type: number
          nullable: true
          description: MACD line (fast EMA - slow EMA)
        signal:
          type: number
          nullable: true
          description: Signal line (EMA of MACD)
        histogram:
          type: number
          nullable: true
          description: MACD histogram (MACD - signal)

    AroonData:
      type: object
      nullable: true
      properties:
        aroonUp:
          type: number
          nullable: true
          description: Aroon Up line (0-100)
        aroonDown:
          type: number
          nullable: true
          description: Aroon Down line (0-100)

    SuperTrendData:
      type: object
      nullable: true
      properties:
        value:
          type: number
          nullable: true
          description: SuperTrend line value
        trend:
          type: string
          nullable: true
          enum: [up, down]
          description: Current trend direction

    IchimokuData:
      type: object
      nullable: true
      properties:
        conversionLine:
          type: number
          nullable: true
          description: Tenkan-sen (9-period)
        baseLine:
          type: number
          nullable: true
          description: Kijun-sen (26-period)
        leadingSpanA:
          type: number
          nullable: true
          description: Senkou Span A (leading)
        leadingSpanB:
          type: number
          nullable: true
          description: Senkou Span B (leading)
        laggingSpan:
          type: number
          nullable: true
          description: Chikou Span (lagging)

    BullBearPowerData:
      type: object
      nullable: true
      properties:
        bullPower:
          type: number
          nullable: true
          description: Bull Power (High - EMA)
        bearPower:
          type: number
          nullable: true
          description: Bear Power (Low - EMA)

    ElderRayData:
      type: object
      nullable: true
      properties:
        bullPower:
          type: number
          nullable: true
          description: Elder Ray Bull Power
        bearPower:
          type: number
          nullable: true
          description: Elder Ray Bear Power

    BollingerBandsData:
      type: object
      nullable: true
      properties:
        upper:
          type: number
          nullable: true
          description: Upper Bollinger Band (middle + 2)
        middle:
          type: number
          nullable: true
          description: Middle Band (SMA 20)
        lower:
          type: number
          nullable: true
          description: Lower Bollinger Band (middle - 2)

    ChannelData:
      type: object
      nullable: true
      description: Three-line channel indicator (Keltner Channels or Donchian Channels)
      properties:
        upper:
          type: number
          nullable: true
          description: Upper channel line
        middle:
          type: number
          nullable: true
          description: Middle channel line
        lower:
          type: number
          nullable: true
          description: Lower channel line

    NewsArticle:
      type: object
      description: A scraped news article from stockanalysis.com
      properties:
        title:
          type: string
          description: Article headline
          example: "Fed holds rates steady amid inflation concerns"
        link:
          type: string
          description: URL to the full article
          example: "https://www.reuters.com/article/fed-rates"
        source:
          type: string
          description: News publisher/source name
          example: Reuters
        img:
          type: string
          description: Thumbnail image URL (may be "/logo.svg" for fallback)
          example: "https://cdn.snapi.dev/images/v1/f/e/d/gen1.jpg"
        time:
          type: string
          description: Relative publication time (e.g., "2 hours ago", "1 day ago")
          example: "2 hours ago"

    OptionsResponse:
      type: object
      description: Yahoo Finance options chain response wrapper
      properties:
        optionChain:
          type: object
          properties:
            result:
              type: array
              items:
                $ref: '#/components/schemas/OptionChainResult'
            error:
              nullable: true
              description: Error object if request failed

    OptionChainResult:
      type: object
      description: Options data for an underlying symbol
      properties:
        underlyingSymbol:
          type: string
          nullable: true
          example: AAPL
        expirationDates:
          type: array
          description: Available expiration dates (Unix timestamps)
          items:
            type: integer
            format: int64
        strikes:
          type: array
          description: Available strike prices
          items:
            type: number
            format: double
        hasMiniOptions:
          type: boolean
          nullable: true
        options:
          type: array
          description: Option chains by expiration date
          items:
            $ref: '#/components/schemas/OptionChain'

    OptionChain:
      type: object
      properties:
        expirationDate:
          type: integer
          format: int64
        hasMiniOptions:
          type: boolean
          nullable: true
        calls:
          type: array
          items:
            $ref: '#/components/schemas/OptionContract'
        puts:
          type: array
          items:
            $ref: '#/components/schemas/OptionContract'

    OptionContract:
      type: object
      properties:
        contractSymbol:
          type: string
        strike:
          type: number
        currency:
          type: string
        lastPrice:
          type: number
        change:
          type: number
        percentChange:
          type: number
        volume:
          type: integer
        openInterest:
          type: integer
        bid:
          type: number
        ask:
          type: number
        contractSize:
          type: string
        expiration:
          type: integer
        lastTradeDate:
          type: integer
        impliedVolatility:
          type: number
        inTheMoney:
          type: boolean

    Recommendation:
      type: object
      properties:
        symbol:
          type: string
        recommendations:
          type: array
          items:
            $ref: '#/components/schemas/SimilarSymbol'

    SimilarSymbol:
      type: object
      properties:
        symbol:
          type: string
          description: Recommended stock symbol
          example: AMZN
        score:
          type: number
          format: double
          description: Recommendation similarity score (higher = more similar)

    FinancialStatement:
      type: object
      description: Financial statement data organized by metric and date
      properties:
        symbol:
          type: string
          description: Stock symbol
          example: AAPL
        statementType:
          type: string
          description: Type of statement (income, balance, cashflow)
          example: income
        frequency:
          type: string
          description: Data frequency (annual or quarterly)
          example: annual
        statement:
          type: object
          description: Financial metrics mapped to date-value pairs
          additionalProperties:
            type: object
            additionalProperties:
              type: number
          example:
            TotalRevenue:
              "2024-09-30": 391035000000
              "2023-09-30": 383285000000
            NetIncome:
              "2024-09-30": 100913000000
              "2023-09-30": 96995000000

    ScreenersResponse:
      type: object
      description: Response from screener endpoint
      properties:
        quotes:
          type: array
          description: Array of quotes matching the screener criteria
          items:
            $ref: '#/components/schemas/ScreenerQuote'
        type:
          type: string
          description: Screener type identifier (e.g., "most_actives", "day_gainers")
          example: most_actives
        description:
          type: string
          description: Human-readable description of the screener
          example: "Stocks ordered in descending order by intraday trade volume"
        lastUpdated:
          type: integer
          format: int64
          nullable: true
          description: Timestamp of last data update (milliseconds for custom screener, seconds for predefined)
          example: 1747133602605
        total:
          type: integer
          format: int64
          nullable: true
          description: Total number of matching results (only present in custom screener responses, for pagination)

    ScreenerQuote:
      type: object
      description: Quote data from a screener result
      properties:
        symbol:
          type: string
          example: NVDA
        shortName:
          type: string
          example: NVIDIA Corporation
        longName:
          type: string
          nullable: true
        quoteType:
          type: string
          example: EQUITY
        exchange:
          type: string
          example: NMS
        regularMarketPrice:
          $ref: '#/components/schemas/FormattedValue'
        regularMarketChange:
          $ref: '#/components/schemas/FormattedValue'
        regularMarketChangePercent:
          $ref: '#/components/schemas/FormattedValue'
        regularMarketVolume:
          $ref: '#/components/schemas/FormattedValue'
        marketCap:
          $ref: '#/components/schemas/FormattedValue'
        fiftyTwoWeekHigh:
          $ref: '#/components/schemas/FormattedValue'
        fiftyTwoWeekLow:
          $ref: '#/components/schemas/FormattedValue'
        trailingPE:
          $ref: '#/components/schemas/FormattedValue'
        forwardPE:
          $ref: '#/components/schemas/FormattedValue'
        dividendYield:
          $ref: '#/components/schemas/FormattedValue'
        averageAnalystRating:
          type: string
          nullable: true
          example: "1.3 - Strong Buy"

    FormattedValue:
      type: object
      description: Yahoo Finance formatted value with raw and display formats
      properties:
        raw:
          type: number
          description: Raw numeric value
        fmt:
          type: string
          description: Formatted display string
          nullable: true
        longFmt:
          type: string
          description: Long formatted display string
          nullable: true

    CustomScreenerRequest:
      type: object
      description: Request body for custom screener queries
      properties:
        quoteType:
          type: string
          enum: [EQUITY, MUTUALFUND]
          default: EQUITY
          description: Type of securities to screen
        size:
          type: integer
          minimum: 1
          maximum: 250
          default: 25
          description: Number of results to return
        offset:
          type: integer
          minimum: 0
          default: 0
          description: Pagination offset
        sortField:
          type: string
          description: Field to sort by (e.g., "intradaymarketcap", "percentchange")
          example: intradaymarketcap
        sortType:
          type: string
          enum: [ASC, DESC]
          default: DESC
          description: Sort direction
        filters:
          type: array
          description: Filter conditions to apply
          items:
            $ref: '#/components/schemas/FilterCondition'
        format:
          type: string
          enum: [raw, pretty, both]
          default: raw
          description: Response value format
        fields:
          type: string
          description: Comma-separated fields to include in response
          nullable: true

    FilterCondition:
      type: object
      description: A single filter condition
      required:
        - field
        - operator
        - value
      properties:
        field:
          type: string
          description: Field name to filter on
          example: region
        operator:
          type: string
          enum: [eq, gt, gte, lt, lte, btwn]
          description: Comparison operator
          example: eq
        value:
          oneOf:
            - type: string
            - type: number
            - type: array
              items:
                type: number
          description: Filter value (use array for "btwn" operator)
          example: us

    SectorResponse:
      type: object
      description: Comprehensive sector data
      properties:
        name:
          type: string
          description: Sector display name
          example: Technology
        key:
          type: string
          description: Sector key used for API calls
          example: technology
        symbol:
          type: string
          nullable: true
          description: Sector index symbol
          example: "^YH311"
        overview:
          $ref: '#/components/schemas/SectorOverview'
        performance:
          $ref: '#/components/schemas/SectorPerformance'
        benchmark:
          $ref: '#/components/schemas/SectorPerformance'
        benchmarkName:
          type: string
          nullable: true
          description: Benchmark name for comparison
          example: S&P 500
        topCompanies:
          type: array
          description: Top companies in the sector by market cap
          items:
            $ref: '#/components/schemas/SectorCompany'
        topEtfs:
          type: array
          description: ETFs tracking this sector
          items:
            $ref: '#/components/schemas/SectorETF'
        topMutualFunds:
          type: array
          description: Mutual funds focused on this sector
          items:
            $ref: '#/components/schemas/SectorMutualFund'
        industries:
          type: array
          description: Industries within this sector
          items:
            $ref: '#/components/schemas/Industry'
        researchReports:
          type: array
          description: Research reports for this sector
          items:
            $ref: '#/components/schemas/ResearchReport'

    SectorOverview:
      type: object
      description: Sector overview statistics
      properties:
        description:
          type: string
          nullable: true
          description: Sector description
        companiesCount:
          type: integer
          nullable: true
          description: Number of companies in the sector
          example: 828
        marketCap:
          type: number
          format: double
          nullable: true
          description: Total market capitalization (raw value)
        marketWeight:
          type: number
          format: double
          nullable: true
          description: Sector weight in the overall market (0-1)
          example: 0.3038
        industriesCount:
          type: integer
          nullable: true
          description: Number of industries within the sector
        employeeCount:
          type: integer
          format: int64
          nullable: true
          description: Total employee count across sector companies

    SectorPerformance:
      type: object
      description: Sector performance metrics
      properties:
        dayChangePercent:
          type: number
          format: double
          nullable: true
          description: Daily change percentage
        ytdChangePercent:
          type: number
          format: double
          nullable: true
          description: Year-to-date change percentage
        oneYearChangePercent:
          type: number
          format: double
          nullable: true
          description: 1-year change percentage
        threeYearChangePercent:
          type: number
          format: double
          nullable: true
          description: 3-year change percentage
        fiveYearChangePercent:
          type: number
          format: double
          nullable: true
          description: 5-year change percentage

    SectorCompany:
      type: object
      description: Company within a sector
      properties:
        symbol:
          type: string
          description: Stock ticker symbol
          example: NVDA
        name:
          type: string
          nullable: true
          description: Company name
          example: NVIDIA Corporation
        lastPrice:
          type: number
          format: double
          nullable: true
          description: Last traded price
          example: 190.53
        marketCap:
          type: number
          format: double
          nullable: true
          description: Market capitalization
          example: 4638833880279
        marketWeight:
          type: number
          format: double
          nullable: true
          description: Weight within the sector (0-1)
          example: 0.19622724
        dayChangePercent:
          type: number
          format: double
          nullable: true
          description: Daily change percentage
        ytdReturn:
          type: number
          format: double
          nullable: true
          description: Year-to-date return
        rating:
          type: string
          nullable: true
          description: Analyst rating
          example: Strong Buy
        targetPrice:
          type: number
          format: double
          nullable: true
          description: Analyst target price

    SectorETF:
      type: object
      description: ETF tracking the sector
      properties:
        symbol:
          type: string
          example: XLK
        name:
          type: string
          nullable: true
        lastPrice:
          type: number
          format: double
          nullable: true
          description: Last traded price (raw value)
        netAssets:
          type: number
          format: double
          nullable: true
          description: Net assets under management (raw value)
        expenseRatio:
          type: number
          format: double
          nullable: true
          description: Expense ratio (raw value)
        ytdReturn:
          type: number
          format: double
          nullable: true
          description: Year-to-date return (raw value)

    SectorMutualFund:
      type: object
      description: Mutual fund focused on the sector
      properties:
        symbol:
          type: string
        name:
          type: string
          nullable: true
        lastPrice:
          type: number
          format: double
          nullable: true
          description: Last traded price / NAV (raw value)
        netAssets:
          type: number
          format: double
          nullable: true
          description: Net assets under management (raw value)
        expenseRatio:
          type: number
          format: double
          nullable: true
          description: Expense ratio (raw value)
        ytdReturn:
          type: number
          format: double
          nullable: true
          description: Year-to-date return (raw value)

    Industry:
      type: object
      description: Industry within a sector
      properties:
        name:
          type: string
          description: Industry name
          example: Semiconductors
        key:
          type: string
          nullable: true
          description: Industry key/slug
          example: semiconductors
        symbol:
          type: string
          nullable: true
          description: Industry index symbol
          example: "^YH31130020"
        marketWeight:
          type: number
          format: double
          nullable: true
          description: Weight within the sector
        dayChangePercent:
          type: number
          format: double
          nullable: true
        ytdReturn:
          type: number
          format: double
          nullable: true

    ResearchReport:
      type: object
      description: Research report for the sector
      properties:
        id:
          type: string
          description: Report identifier
        headline:
          type: string
          nullable: true
          description: Report headline (may contain HTML)
        provider:
          type: string
          nullable: true
          description: Research provider (e.g., "Argus Research", "Morningstar")
        reportDate:
          type: string
          nullable: true
          description: Report publication date (ISO 8601)
        reportTitle:
          type: string
          nullable: true
          description: Full report title
        reportType:
          type: string
          nullable: true
          description: Report type (e.g., "Technical Analysis", "Analyst Report")
        targetPrice:
          type: number
          format: double
          nullable: true
          description: Analyst target price
        targetPriceStatus:
          type: string
          nullable: true
          description: Target price status (e.g., "Maintained", "Raised", "Lowered")
        investmentRating:
          type: string
          nullable: true
          description: Investment rating (e.g., "Bullish", "Bearish")

    IndustryResponse:
      type: object
      description: Comprehensive industry data
      properties:
        name:
          type: string
          description: Industry display name
          example: Semiconductors
        key:
          type: string
          description: Industry key/slug for API calls
          example: semiconductors
        symbol:
          type: string
          nullable: true
          description: Industry index symbol
          example: "^YH31130020"
        sectorName:
          type: string
          nullable: true
          description: Parent sector name
          example: Technology
        sectorKey:
          type: string
          nullable: true
          description: Parent sector key
          example: technology
        overview:
          $ref: '#/components/schemas/IndustryOverview'
        performance:
          $ref: '#/components/schemas/IndustryPerformance'
        benchmark:
          $ref: '#/components/schemas/BenchmarkPerformance'
        topCompanies:
          type: array
          description: Top companies by market cap
          items:
            $ref: '#/components/schemas/IndustryCompany'
        topPerformingCompanies:
          type: array
          description: Top performing companies by YTD return
          items:
            $ref: '#/components/schemas/PerformingCompany'
        topGrowthCompanies:
          type: array
          description: Top growth companies by growth estimate
          items:
            $ref: '#/components/schemas/GrowthCompany'
        researchReports:
          type: array
          description: Research reports for this industry
          items:
            $ref: '#/components/schemas/IndustryResearchReport'

    IndustryOverview:
      type: object
      description: Industry overview statistics
      properties:
        description:
          type: string
          nullable: true
          description: Industry description
        companiesCount:
          type: integer
          nullable: true
          description: Number of companies in the industry
          example: 59
        marketCap:
          type: number
          format: double
          nullable: true
          description: Total market cap
          example: 8057445154816
        marketWeight:
          type: number
          format: double
          nullable: true
          description: Industry weight within the sector (0-1)
          example: 0.3401587
        employeeCount:
          type: integer
          format: int64
          nullable: true
          description: Total employee count

    IndustryPerformance:
      type: object
      description: Industry performance metrics
      properties:
        dayChangePercent:
          type: number
          format: double
          nullable: true
        ytdChangePercent:
          type: number
          format: double
          nullable: true
        oneYearChangePercent:
          type: number
          format: double
          nullable: true
        threeYearChangePercent:
          type: number
          format: double
          nullable: true
        fiveYearChangePercent:
          type: number
          format: double
          nullable: true

    BenchmarkPerformance:
      type: object
      description: Benchmark performance for comparison (e.g., S&P 500)
      properties:
        name:
          type: string
          nullable: true
          description: Benchmark name
          example: S&P 500
        dayChangePercent:
          type: number
          format: double
          nullable: true
        ytdChangePercent:
          type: number
          format: double
          nullable: true
        oneYearChangePercent:
          type: number
          format: double
          nullable: true
        threeYearChangePercent:
          type: number
          format: double
          nullable: true
        fiveYearChangePercent:
          type: number
          format: double
          nullable: true

    IndustryCompany:
      type: object
      description: Company within an industry
      properties:
        symbol:
          type: string
          example: NVDA
        name:
          type: string
          nullable: true
          example: NVIDIA Corporation
        lastPrice:
          type: number
          format: double
          nullable: true
        marketCap:
          type: number
          format: double
          nullable: true
        marketWeight:
          type: number
          format: double
          nullable: true
          description: Weight within the industry (0-1)
        dayChangePercent:
          type: number
          format: double
          nullable: true
        ytdReturn:
          type: number
          format: double
          nullable: true
        rating:
          type: string
          nullable: true
          example: Strong Buy
        targetPrice:
          type: number
          format: double
          nullable: true

    PerformingCompany:
      type: object
      description: Top performing company by YTD return
      properties:
        symbol:
          type: string
          example: LASR
        name:
          type: string
          nullable: true
        lastPrice:
          type: number
          format: double
          nullable: true
        ytdReturn:
          type: number
          format: double
          nullable: true
          description: Year-to-date return (e.g., 2.7369 = 273.69%)
        targetPrice:
          type: number
          format: double
          nullable: true

    GrowthCompany:
      type: object
      description: Top growth company by growth estimate
      properties:
        symbol:
          type: string
          example: MU
        name:
          type: string
          nullable: true
        lastPrice:
          type: number
          format: double
          nullable: true
        ytdReturn:
          type: number
          format: double
          nullable: true
        growthEstimate:
          type: number
          format: double
          nullable: true
          description: Growth estimate (e.g., 5.84 = 584%)

    IndustryResearchReport:
      type: object
      description: Research report for an industry
      properties:
        id:
          type: string
          nullable: true
        title:
          type: string
          nullable: true
        provider:
          type: string
          nullable: true
          example: Argus Research
        reportDate:
          type: string
          nullable: true
          description: Report date (ISO 8601)
        reportType:
          type: string
          nullable: true
          example: Quantitative Report
        investmentRating:
          type: string
          nullable: true
          example: Bullish
        targetPrice:
          type: number
          format: double
          nullable: true
        targetPriceStatus:
          type: string
          nullable: true
          example: Increased

    SearchResponse:
      type: object
      description: Search results containing quotes, news, and research reports
      properties:
        count:
          type: integer
          nullable: true
          description: Total count of results
        quotes:
          type: array
          description: Matching quotes (stocks, ETFs, indices, cultural assets)
          items:
            $ref: '#/components/schemas/SearchQuote'
        news:
          type: array
          nullable: true
          description: Related news articles (when news count > 0)
          items:
            $ref: '#/components/schemas/SearchNews'
        researchReports:
          type: array
          nullable: true
          description: Research reports (when research is enabled)
          items:
            $ref: '#/components/schemas/SearchResearchReport'
        totalTime:
          type: integer
          format: int64
          nullable: true
          description: Total search time in milliseconds

    SearchQuote:
      type: object
      description: A quote result from search
      properties:
        symbol:
          type: string
          description: Stock/index symbol
          example: AAPL
        shortName:
          type: string
          nullable: true
          description: Short company name
          example: Apple Inc.
        longName:
          type: string
          nullable: true
          description: Full company name
          example: Apple Inc.
        quoteType:
          type: string
          nullable: true
          description: Quote type (EQUITY, ETF, INDEX, MUTUALFUND, CURRENCY, etc.)
          example: EQUITY
        exchange:
          type: string
          nullable: true
          description: Exchange code
          example: NMS
        exchDisp:
          type: string
          nullable: true
          description: Exchange display name
          example: NASDAQ
        typeDisp:
          type: string
          nullable: true
          description: Type display name (Equity, ETF, Index, Cultural Asset)
          example: Equity
        industry:
          type: string
          nullable: true
          description: Industry key
          example: consumer-electronics
        industryDisp:
          type: string
          nullable: true
          description: Industry display name
          example: Consumer Electronics
        sector:
          type: string
          nullable: true
          description: Sector key
          example: technology
        sectorDisp:
          type: string
          nullable: true
          description: Sector display name
          example: Technology
        isYahooFinance:
          type: boolean
          nullable: true
          description: Whether this is a Yahoo Finance symbol
        dispSecIndFlag:
          type: boolean
          nullable: true
          description: Display sector/industry flag
        logoUrl:
          type: string
          nullable: true
          description: Company logo URL
          example: "https://s.yimg.com/lb/logos/AAPL_300.png"
        score:
          type: number
          format: double
          nullable: true
          description: Search relevance score
        index:
          type: string
          nullable: true
          description: Index membership
        prevName:
          type: string
          nullable: true
          description: Previous company name (if renamed)
        nameChangeDate:
          type: string
          nullable: true
          description: Date of name change

    SearchNews:
      type: object
      description: A news result from search
      properties:
        uuid:
          type: string
          nullable: true
          description: Unique news article identifier
        title:
          type: string
          nullable: true
          description: Article title
        publisher:
          type: string
          nullable: true
          description: Publisher name
        link:
          type: string
          nullable: true
          description: Article URL
        providerPublishTime:
          type: integer
          format: int64
          nullable: true
          description: Publication timestamp (Unix epoch seconds)
        type:
          type: string
          nullable: true
          description: Article type (STORY, VIDEO, etc.)
        thumbnail:
          $ref: '#/components/schemas/NewsThumbnail'
        relatedTickers:
          type: array
          nullable: true
          items:
            type: string
          description: Related stock symbols

    SearchResearchReport:
      type: object
      description: A research report from search results
      properties:
        reportHeadline:
          type: string
          nullable: true
          description: Report headline/title
        author:
          type: string
          nullable: true
          description: Report author
        reportDate:
          type: integer
          format: int64
          nullable: true
          description: Report date (Unix timestamp)
        id:
          type: string
          nullable: true
          description: Report ID
        provider:
          type: string
          nullable: true
          description: Research provider
          example: Argus Research

    LookupResponse:
      type: object
      description: Lookup results containing type-filtered quotes
      properties:
        quotes:
          type: array
          description: Matching quotes filtered by asset type
          items:
            $ref: '#/components/schemas/LookupQuote'
        start:
          type: integer
          nullable: true
          description: Starting index
        count:
          type: integer
          nullable: true
          description: Total result count

    LookupQuote:
      type: object
      description: A quote result from lookup
      properties:
        symbol:
          type: string
          description: Stock/asset symbol
          example: AAPL
        shortName:
          type: string
          nullable: true
          description: Short name
          example: Apple Inc.
        longName:
          type: string
          nullable: true
          description: Full name
        quoteType:
          type: string
          nullable: true
          description: Asset type (equity, etf, mutualfund, index, future, currency, cryptocurrency)
          example: equity
        exchange:
          type: string
          nullable: true
          description: Exchange code
          example: NMS
        exchDisp:
          type: string
          nullable: true
          description: Exchange display name
        typeDisp:
          type: string
          nullable: true
          description: Type display name
        industry:
          type: string
          nullable: true
          description: Industry classification
        sector:
          type: string
          nullable: true
          description: Sector classification
        regularMarketPrice:
          type: number
          format: double
          nullable: true
          description: Current/last price
        regularMarketChange:
          type: number
          format: double
          nullable: true
          description: Price change
        regularMarketChangePercent:
          type: number
          format: double
          nullable: true
          description: Price change percent
        regularMarketPreviousClose:
          type: number
          format: double
          nullable: true
          description: Previous close price
        logoUrl:
          type: string
          nullable: true
          description: Company logo URL (when logo=true)
          example: "https://s.yimg.com/lb/brands/50x50_nvidia.png"
        companyLogoUrl:
          type: string
          nullable: true
          description: Alternate company logo URL (when logo=true)

    Error:
      type: object
      properties:
        error:
          type: string
        message:
          type: string

    Currency:
      type: object
      description: Currency pair information
      properties:
        shortName:
          type: string
          nullable: true
          description: Short name (e.g., "USD/EUR")
          example: "USD/EUR"
        longName:
          type: string
          nullable: true
          description: Long name (e.g., "USD/EUR")
          example: "USD/EUR"
        symbol:
          type: string
          nullable: true
          description: Symbol (e.g., "USDEUR=X")
          example: "USDEUR=X"
        localLongName:
          type: string
          nullable: true
          description: Local long name
          example: "USD/EUR"

    Exchange:
      type: object
      description: Supported exchange information
      properties:
        country:
          type: string
          description: Country or region where the exchange operates
          example: "Japan"
        market:
          type: string
          description: Name of the market or index
          example: "Tokyo Stock Exchange"
        suffix:
          type: string
          description: Symbol suffix for this exchange (N/A if none needed)
          example: ".T"
        delay:
          type: string
          description: Data delay (e.g., "Real-time", "15 min", "20 min")
          example: "20 min"
        dataProvider:
          type: string
          description: Data provider name
          example: "ICE Data Services"

    MarketSummaryQuote:
      type: object
      description: Market summary quote (index, currency, commodity, etc.)
      properties:
        symbol:
          type: string
          description: Stock/index symbol
          example: "^GSPC"
        fullExchangeName:
          type: string
          nullable: true
          description: Full market name
          example: "SNP"
        exchange:
          type: string
          nullable: true
          description: Exchange code
          example: "SNP"
        shortName:
          type: string
          nullable: true
          description: Short name
          example: "S&P 500"
        quoteType:
          type: string
          nullable: true
          description: Quote type (INDEX, CURRENCY, FUTURE, etc.)
          example: "INDEX"
        marketState:
          type: string
          nullable: true
          description: Market state (REGULAR, PRE, POST, CLOSED)
          example: "CLOSED"
        regularMarketPrice:
          $ref: '#/components/schemas/FormattedValue'
        regularMarketChange:
          $ref: '#/components/schemas/FormattedValue'
        regularMarketChangePercent:
          $ref: '#/components/schemas/FormattedValue'
        regularMarketPreviousClose:
          $ref: '#/components/schemas/FormattedValue'
        regularMarketTime:
          $ref: '#/components/schemas/FormattedValue'
        spark:
          $ref: '#/components/schemas/SparkData'

    SparkData:
      type: object
      description: Spark chart mini-data for market summary
      properties:
        close:
          type: array
          nullable: true
          items:
            type: number
            nullable: true
          description: Close prices
        timestamp:
          type: array
          nullable: true
          items:
            type: integer
            format: int64
          description: Timestamps
        symbol:
          type: string
          nullable: true
          description: Symbol
        previousClose:
          type: number
          format: double
          nullable: true
          description: Previous close
        chartPreviousClose:
          type: number
          format: double
          nullable: true
          description: Chart previous close

    TrendingQuote:
      type: object
      description: A trending stock/symbol
      properties:
        symbol:
          type: string
          description: Stock symbol
          example: "NVDA"

    Region:
      type: string
      description: Market region code
      enum:
        - AR  # Argentina
        - AU  # Australia
        - BR  # Brazil
        - CA  # Canada
        - CN  # China
        - DK  # Denmark
        - FI  # Finland
        - FR  # France
        - DE  # Germany
        - GR  # Greece
        - HK  # Hong Kong
        - IN  # India
        - IL  # Israel
        - IT  # Italy
        - MY  # Malaysia
        - NZ  # New Zealand
        - NO  # Norway
        - PT  # Portugal
        - RU  # Russia
        - SG  # Singapore
        - ES  # Spain
        - SE  # Sweden
        - TW  # Taiwan
        - TH  # Thailand
        - TR  # Turkey
        - GB  # United Kingdom
        - US  # United States
        - VN  # Vietnam
      default: US

    HoursResponse:
      type: object
      description: Market hours response containing market time data
      properties:
        markets:
          type: array
          items:
            $ref: '#/components/schemas/MarketTime'

    MarketTime:
      type: object
      description: Market time information for a specific region
      properties:
        id:
          type: string
          description: Market identifier (e.g., "us", "jp", "gb")
          example: us
        name:
          type: string
          description: Human-readable market name
          example: U.S. markets
        status:
          type: string
          description: Current market status (e.g., "open", "closed")
          example: closed
        message:
          type: string
          description: Status message
          example: U.S. markets closed
        open:
          type: string
          format: date-time
          description: Market open time (ISO 8601)
          example: "2025-12-26T14:30:00Z"
        close:
          type: string
          format: date-time
          description: Market close time (ISO 8601)
          example: "2025-12-26T21:00:00Z"
        time:
          type: string
          format: date-time
          description: Current time (ISO 8601)
          example: "2025-12-27T01:06:14Z"
        timezone:
          type: string
          description: Timezone name (IANA format)
          example: America/New_York
        timezoneShort:
          type: string
          description: Short timezone name
          example: EST
        gmtOffset:
          type: integer
          description: GMT offset in seconds
          example: -18000
        dst:
          type: boolean
          description: Whether daylight saving time is in effect
          example: false

    BatchSparksResponse:
      type: object
      description: Response from batch spark endpoint with successful sparks and errors
      properties:
        sparks:
          type: object
          description: Successfully fetched sparks, keyed by symbol
          additionalProperties:
            $ref: '#/components/schemas/Spark'
        errors:
          type: object
          description: Symbols that failed to fetch, with error messages
          additionalProperties:
            type: string

    BatchChartsResponse:
      type: object
      description: Response from batch charts endpoint with successful charts and errors
      properties:
        charts:
          type: object
          description: Successfully fetched charts, keyed by symbol
          additionalProperties:
            $ref: '#/components/schemas/Chart'
        errors:
          type: object
          description: Symbols that failed to fetch, with error messages
          additionalProperties:
            type: string

    BatchDividendsResponse:
      type: object
      description: Response from batch dividends endpoint with successful dividend lists and errors
      properties:
        dividends:
          type: object
          description: Successfully fetched dividend histories, keyed by symbol
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/Dividend'
        errors:
          type: object
          description: Symbols that failed to fetch, with error messages
          additionalProperties:
            type: string

    BatchSplitsResponse:
      type: object
      description: Response from batch splits endpoint with successful split lists and errors
      properties:
        splits:
          type: object
          description: Successfully fetched split histories, keyed by symbol
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/Split'
        errors:
          type: object
          description: Symbols that failed to fetch, with error messages
          additionalProperties:
            type: string

    BatchCapitalGainsResponse:
      type: object
      description: Response from batch capital gains endpoint with successful capital gains lists and errors
      properties:
        capital_gains:
          type: object
          description: Successfully fetched capital gains histories, keyed by symbol
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/CapitalGain'
        errors:
          type: object
          description: Symbols that failed to fetch, with error messages
          additionalProperties:
            type: string

    BatchFinancialsResponse:
      type: object
      description: Response from batch financials endpoint with successful financial statements and errors
      properties:
        financials:
          type: object
          description: Successfully fetched financial statements, keyed by symbol
          additionalProperties:
            $ref: '#/components/schemas/FinancialStatement'
        errors:
          type: object
          description: Symbols that failed to fetch, with error messages
          additionalProperties:
            type: string

    BatchRecommendationsResponse:
      type: object
      description: Response from batch recommendations endpoint with successful recommendations and errors
      properties:
        recommendations:
          type: object
          description: Successfully fetched recommendations, keyed by symbol
          additionalProperties:
            $ref: '#/components/schemas/Recommendation'
        errors:
          type: object
          description: Symbols that failed to fetch, with error messages
          additionalProperties:
            type: string

    BatchOptionsResponse:
      type: object
      description: Response from batch options endpoint with successful options chains and errors
      properties:
        options:
          type: object
          description: Successfully fetched options chains, keyed by symbol
          additionalProperties:
            $ref: '#/components/schemas/Options'
        errors:
          type: object
          description: Symbols that failed to fetch, with error messages
          additionalProperties:
            type: string

    BatchIndicatorsResponse:
      type: object
      description: Response from batch indicators endpoint with successful indicator summaries and errors
      properties:
        indicators:
          type: object
          description: Successfully calculated indicators, keyed by symbol
          additionalProperties:
            $ref: '#/components/schemas/IndicatorsSummary'
        errors:
          type: object
          description: Symbols that failed to calculate, with error messages
          additionalProperties:
            type: string

    Spark:
      type: object
      properties:
        symbol:
          type: string
        closes:
          type: array
          items:
            type: number
        timestamps:
          type: array
          items:
            type: integer
            format: int64
        interval:
          type: string
        range:
          type: string
        meta:
          $ref: '#/components/schemas/SparkMeta'

    SparkMeta:
      type: object
      description: Metadata for spark chart data
      properties:
        symbol:
          type: string
          description: Stock symbol
        currency:
          type: string
          description: Currency code
        exchangeName:
          type: string
          nullable: true
        fullExchangeName:
          type: string
          nullable: true
        instrumentType:
          type: string
          nullable: true
        firstTradeDate:
          type: integer
          format: int64
          nullable: true
        regularMarketTime:
          type: integer
          format: int64
          nullable: true
        gmtOffset:
          type: integer
          nullable: true
          description: GMT offset in seconds
        timezone:
          type: string
          nullable: true
        exchangeTimezoneName:
          type: string
          nullable: true
        regularMarketPrice:
          type: number
          format: double
          nullable: true
        regularMarketDayHigh:
          type: number
          format: double
          nullable: true
        regularMarketDayLow:
          type: number
          format: double
          nullable: true
        regularMarketVolume:
          type: integer
          format: int64
          nullable: true
        chartPreviousClose:
          type: number
          format: double
          nullable: true
        previousClose:
          type: number
          format: double
          nullable: true
        fiftyTwoWeekHigh:
          type: number
          format: double
          nullable: true
        fiftyTwoWeekLow:
          type: number
          format: double
          nullable: true
        dataGranularity:
          type: string
          nullable: true
        range:
          type: string
          nullable: true
        priceHint:
          type: integer
          nullable: true
        hasPrePostMarketData:
          type: boolean
          nullable: true

  responses:
    BadRequest:
      description: Bad request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

    InternalError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
